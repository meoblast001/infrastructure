---
- hosts: all
  roles:
    - role: nginx
      become: yes
      nginx_sites:
        - file_name: 'default'
          port: 80
          root_path: '/var/www/default'
        - file_name: 'meosite'
          server_name: 'braden-walters.info www.braden-walters.info'
          port: 80
          root_path: '/var/www/meosite'
        - file_name: 'kksystem'
          server_name: 'kksystem.org www.kksystem.org'
          port: 80
          proxy_pass: 'http://unix:/var/server/kksystem/passenger.sock:/'
        - file_name: 'davical'
          server_name: 'braden-walters.info www.braden-walters.info'
          port: 8443
          root_path: '/usr/local/share/davical/htdocs'
          index: index.php
          has_php: yes
    - role: php
      become: yes
    - role: php-fpm-pools
      become: yes
      php_fpm_pools:
        - file_name: 'davical'
          host_name: 'braden-walters.info'
  tasks:
    - name: Create /var/www directory
      file: path=/var/www state=directory owner=deploy group=deploy recurse=yes setype=httpd_sys_content_t
      become: yes
